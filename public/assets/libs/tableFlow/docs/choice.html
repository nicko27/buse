<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation Plugin Choice - TableFlow</title>
    <link rel="stylesheet" href="documentation.css">
    <link rel="stylesheet" href="../src/tableFlow.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Styles spécifiques à cette page */
        body { padding: 2rem; }
        .content { margin-left: 0; } /* Pas de nav latérale */
         h1 { margin-bottom: 2rem; }
         /* Style pour la cohérence (ligne modifiée) */
         tr.modified td { background-color: var(--tf-modified-bg, #fffbeb); }
         /* Style pour les cellules readonly (exemple) */
         .readonly-locked {
             font-style: italic;
             color: var(--tf-text-muted-color, #6c757d); /* Gris */
             cursor: not-allowed !important;
             background-color: var(--tf-header-bg, #f8f9fa) !important; /* Gris très clair */
         }
         /* Styles pour le dropdown (normalement dans tableFlow.css) */
         td.choice-cell { cursor: pointer; position: relative; }
         .tf-choice-dropdown { position: absolute; top: calc(100% + 2px); left: 0; z-index: 1000; display: none; min-width: 200px; max-height: 200px; overflow-y: auto; background: var(--tf-choice-dropdown-bg, white); border: 1px solid var(--tf-border-color, #ddd); border-radius: var(--tf-border-radius, 4px); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
         .tf-choice-dropdown.active { display: block; }
         .tf-choice-search { width: 100%; padding: 8px; border: none; border-bottom: 1px solid var(--tf-border-color, #ddd); outline: none; box-sizing: border-box; font-size: 0.95em; }
         .tf-choice-option { padding: 8px 12px; cursor: pointer; white-space: nowrap; font-size: 0.95em; }
         .tf-choice-option:hover { background-color: var(--tf-choice-option-hover-bg, #f5f5f5); }
         .tf-choice-dropdown .no-results { padding: 8px 12px; color: var(--tf-text-muted-color, #999); font-style: italic; text-align: center; }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">
            <h1>Documentation Plugin Choice</h1>

            <section id="plugin-choice-intro">
                <h2>Objectif</h2>
                <p>
                    Le plugin <strong>Choice</strong> permet aux utilisateurs de sélectionner une valeur pour une cellule parmi une liste d'options prédéfinies. Il offre deux modes de fonctionnement principaux pour l'interaction :
                </p>
                <ul>
                    <li><strong><code>toggle</code> (par défaut) :</strong> L'utilisateur clique sur la cellule pour passer séquentiellement à l'option suivante dans la liste définie. C'est simple et rapide pour des listes courtes (ex: Oui/Non, Basse/Moyenne/Haute).</li>
                    <li><strong><code>searchable</code> :</strong> L'utilisateur clique sur la cellule pour ouvrir une liste déroulante (dropdown) contenant toutes les options. Cette liste inclut un champ de recherche pour filtrer rapidement les options disponibles. C'est idéal pour des listes plus longues (ex: liste d'utilisateurs, catégories, pays).</li>
                </ul>
                <p>
                    Le plugin gère la mise à jour de la valeur interne de la cellule (`data-value`), l'affichage du texte (label) correspondant à la valeur sélectionnée, et peut marquer la ligne comme modifiée. Il permet également de définir certaines options comme étant en lecture seule (non sélectionnables et visuellement distinctes).
                </p>
            </section>

            <section id="plugin-choice-activation">
                <h2>Activation et Configuration HTML</h2>
                <p>
                    Pour activer le plugin Choice sur une colonne, ajoutez l'attribut <code class="attr">th-choice</code> (configurable via `choiceAttribute`) à l'élément <code>&lt;th&gt;</code> correspondant. La valeur de cet attribut peut influencer la configuration :
                </p>
                <ul>
                    <li><strong>Attribut vide (<code class="attr">th-choice</code>) :</strong> Active le plugin pour la colonne. La configuration complète (type d'interaction, liste des options) <strong>doit</strong> être fournie via la configuration JavaScript (`plugins.choice.columns`).</li>
                    <li><strong>Type spécifié (<code class="attr">th-choice="searchable"</code> ou <code class="attr">th-choice="toggle"</code>) :</strong> Force le type d'interaction pour cette colonne, surchargeant l'option `type` éventuellement définie dans la configuration JS. La liste des options (`values`) doit toujours être fournie en JS.</li>
                    <li><strong>Options JSON (<code class="attr">th-choice='["Option 1", "Option 2"]'</code> ou <code class="attr">th-choice='{"type": "searchable", "values": [...]}'</code>) :</strong> <em>(Non recommandé, potentiellement obsolète)</em> Permettait de définir les options directement en HTML. Il est <strong>fortement préférable</strong> de définir les options (`values`, `readOnlyValues`, etc.) dans la configuration JavaScript pour plus de clarté, de flexibilité (objets avec label/valeur) et de maintenabilité.</li>
                </ul>

                <pre><code class="language-html">&lt;!-- Assurez-vous que la table a un ID unique --&gt;
&lt;table id="maTableChoice"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th id="colItem"&gt;Item&lt;/th&gt;
      &lt;!-- Configuré entièrement via JS (type et valeurs) --&gt;
      &lt;th id="colStatut" th-choice&gt;Statut&lt;/th&gt;
      &lt;!-- Force le type 'searchable', valeurs définies en JS --&gt;
      &lt;th id="colCategorie" th-choice="searchable"&gt;Catégorie&lt;/th&gt;
      &lt;!-- Force le type 'toggle', valeurs définies en JS --&gt;
      &lt;th id="colPriorite" th-choice="toggle"&gt;Priorité&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;!-- Lignes de données --&gt;
    &lt;tr id="row1"&gt;
        &lt;td id="colItem_row1"&gt;Ticket #1&lt;/td&gt;
        &lt;!-- data-value stocke la valeur interne, le texte est le label affiché --&gt;
        &lt;td id="colStatut_row1" data-value="pending"&gt;En attente&lt;/td&gt;
        &lt;td id="colCategorie_row1" data-value="bug"&gt;Bug&lt;/td&gt;
        &lt;td id="colPriorite_row1" data-value="high"&gt;Haute&lt;/td&gt;
    &lt;/tr&gt;
     &lt;tr id="row2"&gt;
        &lt;td id="colItem_row2"&gt;Ticket #2&lt;/td&gt;
        &lt;td id="colStatut_row2" data-value="completed"&gt;Terminé&lt;/td&gt;
        &lt;td id="colCategorie_row2" data-value="feature"&gt;Fonctionnalité&lt;/td&gt;
        &lt;td id="colPriorite_row2" data-value="low"&gt;Basse&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;</code></pre>
                <p>
                    Il est crucial d'utiliser l'attribut <code class="attr">data-value</code> sur les éléments <code>&lt;td&gt;</code> pour stocker la valeur réelle (interne, ex: 'pending', 'bug', 'high'). Le contenu textuel initial de la cellule peut être le label correspondant (ex: 'En attente', 'Bug', 'Haute'). Le plugin synchronisera l'affichage du label avec la valeur stockée dans `data-value` lors de l'initialisation et après chaque sélection.
                </p>
            </section>

            <section id="plugin-choice-config-js">
                <h2>Configuration JavaScript</h2>
                <p>
                    La configuration détaillée du plugin, et notamment la liste des options pour chaque colonne, se fait dans l'objet d'options de `TableFlow`, sous la clé <code class="value">plugins.choice</code>.
                </p>
                <pre><code class="language-javascript">// Exemple d'initialisation de TableFlow
import TableFlow from '../src/tableFlow.js'; // Ajustez le chemin

const tableChoice = new TableFlow({
    tableId: 'maTableChoice',
    pluginsPath: '../plugins', // Ajustez
    debug: true,
    plugins: {
        names: ['Choice'], // Activer le plugin
        choice: { // Configuration spécifique pour 'Choice'
            // --- Options Générales du Plugin ---
            // choiceAttribute: 'th-choice', // Défaut
            cellClass: 'choice-cell', // Classe ajoutée aux <td> gérées
            // readOnlyClass: 'readonly-choice', // Classe pour cellules non modifiables (si besoin)
            // modifiedClass: 'modified', // Défaut
            // debug: true, // Logs spécifiques

            // --- Configuration par Colonne (REQUIS) ---
            // La clé est l'ID du <th> correspondant
            columns: {
                'colStatut': { // Config pour th#colStatut (type non spécifié -> 'toggle' par défaut)
                    values: [ // Liste des options possibles
                        // Format Objet: { value: valeur_interne, label: texte_affiché, class?: classe_css }
                        { value: 'pending', label: 'En attente', class: 'status-pending' },
                        { value: 'in_progress', label: 'En cours', class: 'status-progress' },
                        { value: 'completed', label: 'Terminé', class: 'status-completed' },
                        // Format Chaîne simple: valeur et label identiques
                        'cancelled'
                    ],
                    // Optionnel: Définir des valeurs qui bloquent la modification
                    readOnlyValues: [
                        // Format Objet: { value: valeur_bloquee, class?: classe_css_readonly }
                        { value: 'archived', class: 'readonly-locked' }
                    ]
                },
                'colCategorie': { // Config pour th#colCategorie
                    // Le type 'searchable' est forcé par l'attribut HTML, mais on peut le redéfinir ici si besoin
                    // type: 'searchable',
                    values: [
                        { value: 'bug', label: '🐞 Bug / Erreur' }, // Peut contenir HTML simple (icônes)
                        { value: 'feature', label: '✨ Fonctionnalité' },
                        { value: 'improvement', label: '📈 Amélioration' },
                        { value: 'task', label: ' Tâche' },
                        { value: 'question', label: '❓ Question' }
                        // ... potentiellement beaucoup d'autres options
                    ],
                    // Options spécifiques au dropdown searchable
                    searchable: {
                        placeholder: 'Rechercher une catégorie...',
                        minWidth: '250px', // Largeur minimale du dropdown
                        // noResultsText: 'Aucune catégorie trouvée.' // Texte si pas de résultat
                    }
                },
                'colPriorite': { // Config pour th#colPriorite (type 'toggle' forcé par HTML)
                    values: [
                        { value: 'low', label: 'Basse' },
                        { value: 'medium', label: 'Moyenne' },
                        { value: 'high', label: 'Haute' }
                        // Format simple ['low', 'medium', 'high'] fonctionnerait aussi pour toggle
                    ]
                }
            }
        }
    }
});
</code></pre>

                <h3>Tableau Complet des Options de Configuration JS (`plugins.choice`)</h3>
                <div class="info-block">
                    Ce tableau liste toutes les options configurables pour le plugin Choice via l'objet `plugins.choice`.
                </div>
                <table class="documentation-table">
                    <thead>
                        <tr><th>Option (dans `plugins.choice`)</th><th>Type</th><th>Défaut</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code class="attr">choiceAttribute</code></td><td class="type">string</td><td><code class="default">'th-choice'</code></td><td>Nom de l'attribut HTML sur `<th>` pour activer le plugin sur une colonne et éventuellement forcer le type (`toggle`/`searchable`).</td></tr>
                        <tr><td><code class="attr">cellClass</code></td><td class="type">string</td><td><code class="default">'choice-cell'</code></td><td>Classe CSS ajoutée aux `<td>` gérées par ce plugin.</td></tr>
                        <tr><td><code class="attr">readOnlyClass</code></td><td class="type">string</td><td><code class="default">'readonly'</code></td><td>Classe CSS <strong>par défaut</strong> ajoutée aux `<td>` si leur valeur correspond à une entrée dans `readOnlyValues` qui n'a pas de classe spécifique définie.</td></tr>
                        <tr><td><code class="attr">modifiedClass</code></td><td class="type">string</td><td><code class="default">'modified'</code></td><td>Classe CSS utilisée pour marquer les lignes (`<tr>`) modifiées lorsque la valeur change par rapport à l'initiale.</td></tr>
                        <tr><td><code class="attr">debug</code></td><td class="type">boolean</td><td><code class="default">false</code></td><td>Active les logs de débogage spécifiques au plugin Choice. Hérite du `debug` global si non défini.</td></tr>
                        <tr><td><code class="attr">columns</code></td><td class="type">object</td><td><code class="default">{}</code></td><td><strong>(Essentiel)</strong> Objet contenant la configuration pour chaque colonne activée via `th-choice`. La clé est l'ID du `<th>`, la valeur est un objet décrivant la configuration de la colonne (voir tableau suivant).</td></tr>
                    </tbody>
                </table>

                <h3>Structure Complète de Configuration d'une Colonne (dans `plugins.choice.columns[columnId]`)</h3>
                <div class="info-block">
                    Ce tableau détaille toutes les propriétés possibles pour configurer une colonne spécifique à l'intérieur de l'objet `plugins.choice.columns`.
                 </div>
                <table class="documentation-table">
                     <thead>
                         <tr><th>Propriété (dans `columns[columnId]`)</th><th>Type</th><th>Requis?</th><th>Défaut</th><th>Description</th></tr>
                     </thead>
                     <tbody>
                         <tr><td><code class="attr">type</code></td><td class="type">string</td><td>Non</td><td><code class="default">'toggle'</code></td><td>Mode d'interaction : `'toggle'` ou `'searchable'`. Peut être surchargé par la valeur de l'attribut `th-choice` en HTML.</td></tr>
                         <tr><td><code class="attr">values</code></td><td class="type">Array</td><td>Oui</td><td><code class="default">[]</code></td><td>Tableau contenant les options sélectionnables. Chaque élément peut être :<br>- Une chaîne/nombre : La valeur interne et le label affiché sont identiques.<br>- Un objet : `{ value: 'valeur_interne', label: 'Texte affiché', class?: 'classe_css_optionnelle_pour_td' }`. La classe est ajoutée à la `<td>` lorsque cette valeur est sélectionnée.</td></tr>
                         <tr><td><code class="attr">readOnlyValues</code></td><td class="type">Array</td><td>Non</td><td><code class="default">[]</code></td><td>Tableau définissant des valeurs qui, si présentes dans une cellule, rendent cette cellule non modifiable par ce plugin. Chaque élément peut être :<br>- Une chaîne/nombre : La valeur à bloquer.<br>- Un objet : `{ value: 'valeur_bloquee', class?: 'classe_css_readonly_specifique' }`. La classe est ajoutée à la `<td>` pour indiquer visuellement le blocage (surcharge `readOnlyClass`).</td></tr>
                         <tr><td><code class="attr">searchable</code></td><td class="type">object</td><td>Non</td><td><code class="default">{...}</code> (voir ci-dessous)</td><td>Objet contenant la configuration spécifique au mode `searchable` (dropdown). Voir tableau suivant.</td></tr>
                     </tbody>
                 </table>

                 <h3>Options de Configuration pour le Mode `searchable` (dans `columns[columnId].searchable`)</h3>
                 <div class="info-block">
                    Ces options permettent de personnaliser l'apparence et le comportement de la liste déroulante en mode `searchable`. Elles sont fusionnées avec les valeurs par défaut du plugin.
                 </div>
                 <table class="documentation-table">
                     <thead>
                         <tr><th>Propriété (dans `searchable`)</th><th>Type</th><th>Défaut</th><th>Description</th></tr>
                     </thead>
                     <tbody>
                         <tr><td><code class="attr">minWidth</code></td><td class="type">string</td><td><code class="default">'200px'</code></td><td>Largeur minimale CSS de la liste déroulante.</td></tr>
                         <tr><td><code class="attr">dropdownClass</code></td><td class="type">string</td><td><code class="default">'tf-choice-dropdown'</code></td><td>Classe CSS principale ajoutée à l'élément `<div>` de la liste déroulante.</td></tr>
                         <tr><td><code class="attr">optionClass</code></td><td class="type">string</td><td><code class="default">'tf-choice-option'</code></td><td>Classe CSS ajoutée à chaque `<div>` représentant une option dans la liste.</td></tr>
                         <tr><td><code class="attr">searchClass</code></td><td class="type">string</td><td><code class="default">'tf-choice-search'</code></td><td>Classe CSS ajoutée à l'élément `<input>` de recherche dans la liste déroulante.</td></tr>
                         <tr><td><code class="attr">placeholder</code></td><td class="type">string</td><td><code class="default">'Rechercher...'</code></td><td>Texte indicatif affiché dans le champ de recherche (`placeholder`).</td></tr>
                         <tr><td><code class="attr">noResultsText</code></td><td class="type">string</td><td><code class="default">'Aucun résultat'</code></td><td>Texte affiché dans la liste lorsqu'aucune option ne correspond à la recherche.</td></tr>
                     </tbody>
                 </table>
            </section>

            <section id="plugin-choice-how-it-works">
                <h2>Fonctionnement Interne</h2>
                <ul>
                    <li><strong>Initialisation (`init`, `setupChoiceCells`, `setupChoiceCell`):</strong> Identifie les colonnes `th-choice`. Pour chaque cellule `<td>` correspondante, ajoute `cellClass`, `data-plugin="choice"`, `data-choice-type`, `data-choice-column`. Lit la valeur initiale (`data-value` ou texte), trouve le label correspondant dans la configuration `values` et l'affiche (via `updateCellDisplay`, en utilisant le wrapper si présent). Applique le style `readOnly` si nécessaire (`applyReadOnlyStyle`). Attache les écouteurs d'événements globaux (`setupEventListeners`).</li>
                    <li><strong>Gestion du Clic (`handleClick`):</strong> Intercepte les clics sur la table. Si le clic est sur une cellule gérée (`isManagedCell`) et non readonly (`isReadOnly`), détermine le type (`toggle` ou `searchable`) et appelle le handler correspondant.</li>
                    <li><strong>Mode Toggle (`handleToggleClick`):</strong> Récupère les `values` configurées (en excluant les `readOnlyValues`). Trouve l'index de la valeur actuelle parmi les choix disponibles. Calcule l'index suivant (en boucle). Appelle `updateCellValue` avec la nouvelle valeur/label.</li>
                    <li><strong>Mode Searchable (`handleSearchableClick`):</strong> Ferme tout autre dropdown actif (`closeAllDropdowns`). Crée dynamiquement le HTML du dropdown (`createSearchableDropdown`), incluant le champ de recherche et la liste initiale des options (filtrées des `readOnlyValues`). Ajoute le dropdown à la cellule et l'affiche. Attache un écouteur `input` au champ de recherche pour filtrer et réafficher les options (`renderSearchableOptions`). Attache des écouteurs `click` sur chaque option pour appeler `updateCellValue` et fermer le dropdown.</li>
                    <li><strong>Mise à Jour Valeur/Affichage (`updateCellValue`, `updateCellDisplay`, `applyReadOnlyStyle`):</strong> Met à jour l'attribut `data-value`. Appelle `updateCellDisplay` pour mettre à jour le contenu visible (label) en utilisant le sanitizer si disponible. Appelle `applyReadOnlyStyle` pour ajouter/retirer les classes CSS readonly. Déclenche l'événement `cell:change` (`dispatchChangeEvent`).</li>
                    <li><strong>Gestion Readonly (`isReadOnly`, `applyReadOnlyStyle`):</strong> `isReadOnly` vérifie si une valeur donnée est dans la liste `readOnlyValues` de la colonne. `applyReadOnlyStyle` ajoute ou retire les classes CSS correspondantes (classe spécifique de la règle ou `readOnlyClass` par défaut) sur la cellule `<td>`.</li>
                    <li><strong>Gestion des Sauvegardes (`_handleCellSaved`, `_handleRowSaved`):</strong> Met à jour `data-initial-value` avec la valeur actuelle (`data-value`) après une sauvegarde pour réinitialiser l'état modifié. Met également à jour l'affichage (label et style readonly).</li>
                    <li><strong>Nouvelles Lignes (`_handleRowAdded`):</strong> Appelle `setupChoiceCells(newRow)` pour initialiser correctement les cellules choice de la nouvelle ligne.</li>
                    <li><strong>Fermeture Dropdown (`closeAllDropdowns`, `_closeDropdownOnClickOutside`):</strong> Ferme le dropdown `searchable` actif s'il y en a un lorsqu'on clique en dehors d'une cellule choice gérée par ce plugin.</li>
                     <li><strong>Nettoyage (`destroy`):</strong> Supprime les écouteurs d'événements attachés par le plugin (sur la table et le document) et ferme tout dropdown actif.</li>
                </ul>
            </section>

            <section id="plugin-choice-events">
                <h2>Événements</h2>
                <ul>
                    <li><strong>Écoutés :</strong>
                        <ul>
                            <li><code>click</code> (sur la table) : Détecte les clics sur les cellules gérées pour déclencher le toggle ou ouvrir le dropdown.</li>
                            <li><code>click</code> (sur le document, phase capture) : Pour fermer les dropdowns ouverts si le clic a lieu en dehors.</li>
                            <li><code>input</code> (sur l'input de recherche du dropdown) : Pour filtrer les options.</li>
                            <li><code>click</code> (sur les options du dropdown) : Pour sélectionner une valeur.</li>
                            <li><code>cell:saved</code> (sur la table) : Pour mettre à jour `data-initial-value` et l'affichage après sauvegarde.</li>
                            <li><code>row:saved</code> (sur la table) : Pour mettre à jour `data-initial-value` des cellules choice de la ligne.</li>
                            <li><code>row:added</code> (sur la table) : Pour initialiser les nouvelles lignes.</li>
                        </ul>
                    </li>
                    <li><strong>Déclenchés :</strong>
                        <ul>
                            <li><code>cell:change</code> (sur la table) : Après qu'un utilisateur a sélectionné une nouvelle valeur (en mode toggle ou searchable). Contient `{ detail: { cell, value, columnId, rowId, source: 'choice', isModified, eventId, ... } }`.</li>
                        </ul>
                    </li>
                </ul>
            </section>

            <section id="plugin-choice-example">
                <h2>Exemple Complet</h2>
                <p>Cet exemple combine les modes `toggle` et `searchable` et inclut des valeurs en lecture seule.</p>

                <strong>HTML (`index.html`):</strong>
                <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Exemple Choice Plugin&lt;/title&gt;
    &lt;link rel="stylesheet" href="../src/tableFlow.css"&gt;
    &lt;link rel="stylesheet" href="documentation.css"&gt;
    &lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"&gt;
    &lt;style&gt;
        body { padding: 2rem; font-family: sans-serif; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        thead th { background-color: #f2f2f2; }
        tr.modified td { background-color: #fffbeb; }
        td.choice-cell { min-width: 120px; /* Pour meilleure visibilité */ }
        .readonly-locked { font-style: italic; color: #6c757d; cursor: not-allowed !important; background-color: #f8f9fa !important; }
        /* Styles dropdown (normalement dans tableFlow.css) */
        .tf-choice-dropdown{position:absolute;top:calc(100% + 2px);left:0;z-index:1000;display:none;min-width:200px;max-height:200px;overflow-y:auto;background:#fff;border:1px solid #ddd;border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,.1)}
        .tf-choice-dropdown.active{display:block}
        .tf-choice-search{width:100%;padding:8px;border:none;border-bottom:1px solid #ddd;outline:none;box-sizing:border-box;font-size:.95em}
        .tf-choice-option{padding:8px 12px;cursor:pointer;white-space:nowrap;font-size:.95em}
        .tf-choice-option:hover{background-color:#f5f5f5}
        .tf-choice-dropdown .no-results{padding:8px 12px;color:#999;font-style:italic;text-align:center}
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;TableFlow - Exemple Plugin Choice&lt;/h1&gt;
    &lt;p&gt;Cliquez sur les cellules "Statut" (toggle) ou "Assigné" (searchable) pour changer leur valeur.&lt;/p&gt;

    &lt;table id="taskTableChoice"&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th id="taskName"&gt;Tâche&lt;/th&gt;
                &lt;th id="taskStatus" th-choice&gt;Statut (Toggle)&lt;/th&gt;
                &lt;th id="taskAssignee" th-choice="searchable"&gt;Assigné à (Searchable)&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
            &lt;tr id="t1"&gt;
                &lt;td id="taskName_t1"&gt;Corriger le bug #123&lt;/td&gt;
                &lt;td id="taskStatus_t1" data-value="pending"&gt;En attente&lt;/td&gt;
                &lt;td id="taskAssignee_t1" data-value="alice"&gt;Alice&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr id="t2"&gt;
                &lt;td id="taskName_t2"&gt;Implémenter nouvelle feature&lt;/td&gt;
                &lt;td id="taskStatus_t2" data-value="in_progress"&gt;En cours&lt;/td&gt;
                &lt;td id="taskAssignee_t2" data-value="bob"&gt;Bob&lt;/td&gt;
            &lt;/tr&gt;
             &lt;tr id="t3"&gt;
                &lt;td id="taskName_t3"&gt;Archiver vieux projets&lt;/td&gt;
                &lt;td id="taskStatus_t3" data-value="archived"&gt;Archivé&lt;/td&gt; &lt;!-- Sera readonly via JS --&gt;
                &lt;td id="taskAssignee_t3" data-value="system"&gt;Système&lt;/td&gt; &lt;!-- Sera readonly via JS --&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;

    &lt;script type="module"&gt;
        import TableFlow from '../src/tableFlow.js'; // Ajustez le chemin

        const taskTable = new TableFlow({
            tableId: 'taskTableChoice',
            pluginsPath: '../plugins', // Ajustez
            debug: true,
            plugins: {
                names: ['Choice'], // Activer le plugin
                choice: {
                    columns: {
                        'taskStatus': { // Config pour th#taskStatus (type=toggle par défaut)
                            values: [
                                { value: 'pending', label: '⏳ En attente' }, // Label avec icône
                                { value: 'in_progress', label: '⚙️ En cours' },
                                { value: 'completed', label: '✅ Terminé' }
                                // 'archived' n'est pas dans values, mais dans readOnlyValues
                            ],
                            readOnlyValues: [
                                { value: 'archived', class: 'readonly-locked' } // Bloque la valeur 'archived'
                            ]
                        },
                        'taskAssignee': { // Config pour th#taskAssignee (type=searchable via HTML)
                            values: [ // Liste potentiellement longue
                                { value: 'alice', label: 'Alice Dupont' },
                                { value: 'bob', label: 'Bob Martin' },
                                { value: 'charlie', label: 'Charlie Durand' },
                                { value: 'david', label: 'David Petit' },
                                { value: 'eve', label: 'Eve Leroy' }
                                // 'system' n'est pas dans values, mais dans readOnlyValues
                            ],
                             readOnlyValues: [
                                { value: 'system', class: 'readonly-locked' } // Bloque la valeur 'system'
                            ],
                            searchable: {
                                placeholder: 'Chercher un assigné...'
                            }
                        }
                    }
                }
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

                <strong>Fonctionnement de l'exemple :</strong>
                <ol>
                    <li>La colonne "Statut" est en mode `toggle`. Cliquer dessus fera défiler les options : ⏳ En attente -> ⚙️ En cours -> ✅ Terminé -> ⏳ En attente... La ligne "Archiver vieux projets" a le statut "Archivé" (qui n'est pas dans `values` mais dans `readOnlyValues`), donc cliquer sur cette cellule ne fera rien et elle aura la classe `readonly-locked`.</li>
                    <li>La colonne "Assigné à" est en mode `searchable`. Cliquer dessus ouvrira une liste déroulante avec les noms.</li>
                    <li>Vous pouvez taper dans le champ de recherche (ex: "Du") pour filtrer la liste (afficherait "Charlie Durand").</li>
                    <li>Cliquer sur un nom dans la liste mettra à jour la cellule (`data-value` et le label affiché) et fermera le dropdown.</li>
                    <li>La ligne "Archiver vieux projets" a "Système" comme assigné, qui est dans `readOnlyValues`, donc cliquer sur cette cellule ne fera rien et elle aura la classe `readonly-locked`.</li>
                    <li>Modifier une valeur marquera la ligne en jaune pâle (classe `modified`).</li>
                </ol>
            </section>

        </div>
    </div>
</body>
</html>
