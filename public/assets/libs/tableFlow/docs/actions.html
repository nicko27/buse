<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation Plugin Actions - TableFlow</title>
    <link rel="stylesheet" href="documentation.css">
    <link rel="stylesheet" href="../src/tableFlow.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Styles spécifiques à cette page de documentation */
        /* NOTE: Il est préférable de définir les styles TableFlow dans un fichier CSS dédié */
        body { padding: 2rem; }
        .content { margin-left: 0; } /* Pas de nav latérale dans ce doc standalone */
         h1 { margin-bottom: 2rem; }
         /* Style pour la cohérence (ligne modifiée) */
         tr.modified td { background-color: var(--tf-modified-bg, #fffbeb); }
         /* Style pour les cellules d'action (normalement dans tableFlow.css) */
         td.td-actions .cell-wrapper {
             display: flex; /* Utiliser flex pour aligner les icônes/boutons */
             justify-content: space-around; /* Espace autour par défaut */
             align-items: center;
             padding: 0 5px; /* Léger padding horizontal */
             gap: 8px; /* Espace entre les éléments d'action */
             min-height: 1.5em; /* Assurer une hauteur minimale */
         }
         td.td-actions [data-action] { /* Cible les éléments cliquables */
             cursor: pointer;
             opacity: 0.8;
             transition: opacity 0.2s ease, color 0.2s ease;
             color: var(--tf-action-icon-color, var(--tf-info-color, #2563eb)); /* Couleur par défaut */
             background: none; /* Assurer pas de fond par défaut si bouton */
             border: none; /* Assurer pas de bordure par défaut si bouton */
             padding: 0; /* Pas de padding par défaut si bouton */
             font-size: 1em; /* Taille de police normale par défaut */
         }
         td.td-actions [data-action]:hover {
             opacity: 1;
             color: var(--tf-action-icon-hover-color, var(--tf-primary-color, #4f46e5)); /* Couleur au survol */
         }
         /* Style pour les boutons texte si useIcons=false */
         .tf-action-button {
             padding: 2px 5px;
             border: 1px solid #ccc;
             border-radius: 3px;
             background-color: #f8f8f8;
             font-size: 0.85em;
         }
         .tf-action-button:hover {
             background-color: #eee;
         }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">
            <h1>Documentation Plugin Actions</h1>

            <section id="plugin-actions-intro">
                <h2>Objectif</h2>
                <p>
                    Le plugin <strong>Actions</strong> permet d'ajouter une ou plusieurs colonnes contenant des icônes cliquables (ou des boutons texte) à chaque ligne d'un tableau géré par TableFlow. Ces "actions" déclenchent des fonctions JavaScript personnalisées (appelées "handlers") que vous définissez dans la configuration.
                </p>
                <p>
                    Cela vous permet d'implémenter facilement des logiques spécifiques liées à une ligne de données, telles que :
                </p>
                <ul>
                    <li>Sauvegarder les modifications d'une ligne (souvent après édition).</li>
                    <li>Supprimer une ligne.</li>
                    <li>Dupliquer une ligne.</li>
                    <li>Ouvrir une modale d'édition détaillée pour la ligne.</li>
                    <li>Déclencher un workflow spécifique pour l'enregistrement correspondant.</li>
                </ul>
                <p>
                    Le plugin gère automatiquement l'affichage conditionnel de certains boutons (par exemple, afficher l'icône "Sauvegarder" uniquement lorsque la ligne a été modifiée) et peut interagir avec le système de notification de TableFlow et d'autres plugins via les événements et l'API `TableInstance`.
                </p>
            </section>

            <section id="plugin-actions-activation">
                <h2>Activation et Configuration HTML</h2>
                <p>
                    Pour désigner une colonne comme colonne d'actions, ajoutez l'attribut <code class="attr">th-actions</code> (configurable via `actionAttribute`) à l'élément <code>&lt;th&gt;</code> correspondant dans l'en-tête de votre tableau.
                </p>
                <p>
                    La valeur de cet attribut doit être une <strong>liste de noms d'actions</strong> (séparés par des virgules, sans espaces superflus) que vous souhaitez inclure dans cette colonne. Ces noms doivent correspondre exactement aux clés que vous définirez dans l'objet <code class="value">plugins.actions.actions</code> de votre configuration JavaScript.
                </p>
                <pre><code class="language-html">&lt;!-- Assurez-vous que la table a un ID unique --&gt;
&lt;table id="maTableActions"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th id="colData1" th-edit&gt;Donnée Éditable&lt;/th&gt;
      &lt;th id="colData2" th-sql-exclude&gt;Info Interne (Non Incluse dans `data`)&lt;/th&gt;
      &lt;!-- Activation de la colonne d'actions avec les actions 'save' et 'delete' --&gt;
      &lt;th id="colMesActions" th-actions="save,delete"&gt;Opérations&lt;/th&gt;
       &lt;!-- Une autre colonne d'actions possible --&gt;
       &lt;th id="colAutresActions" th-actions="edit,duplicate"&gt;Plus&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr id="item1"&gt;
        &lt;td id="colData1_item1"&gt;Valeur A&lt;/td&gt;
        &lt;td id="colData2_item1"&gt;interne1&lt;/td&gt;
        &lt;td id="colMesActions_item1"&gt;&lt;/td&gt; &lt;!-- Sera peuplé par le plugin --&gt;
        &lt;td id="colAutresActions_item1"&gt;&lt;/td&gt; &lt;!-- Sera peuplé par le plugin --&gt;
    &lt;/tr&gt;
    &lt;!-- Autres lignes --&gt;
  &lt;/tbody&gt;
&lt;/table&gt;</code></pre>
                <p>
                    Vous pouvez également utiliser l'attribut <code class="attr">th-sql-exclude</code> (configurable via `sqlExcludeAttribute`) sur n'importe quel <code>&lt;th&gt;</code> (y compris ceux qui ne sont pas des colonnes d'actions) pour indiquer que la valeur de cette colonne ne doit <strong>pas</strong> être incluse dans l'objet `data` passé aux handlers d'action lors de l'appel à `getRowData()`. C'est utile pour les colonnes purement visuelles, les IDs techniques que vous ne voulez pas renvoyer, ou les colonnes d'actions elles-mêmes.
                </p>
            </section>

            <section id="plugin-actions-config-js">
                <h2>Configuration JavaScript</h2>
                <p>
                    La configuration détaillée du plugin (notamment les fonctions `handler` pour chaque action) se fait dans l'objet d'options de `TableFlow`, sous la clé <code class="value">plugins.actions</code>.
                </p>
                <pre><code class="language-javascript">// Exemple d'initialisation de TableFlow
import TableFlow from '../src/tableFlow.js'; // Ajustez le chemin

const tableAct = new TableFlow({
    tableId: 'maTableActions',
    pluginsPath: '../plugins', // Ajustez
    debug: true,
    plugins: {
        names: ['Actions', 'Edit'], // Activer Actions (et Edit pour l'exemple)
        actions: { // Configuration spécifique pour 'Actions'
            // --- Options Générales ---
            // actionAttribute: 'th-actions', // Défaut
            // sqlExcludeAttribute: 'th-sql-exclude', // Défaut
            // cellClass: 'td-actions', // Défaut
            // modifiedClass: 'modified', // Défaut
            // useIcons: true, // Défaut
            // debug: true, // Activer logs spécifiques

            // Afficher 'save' seulement si la ligne est modifiée
            showOnChange: ['save'], // ou true pour toutes, ou [] (défaut)

            // Déclencher 'save' automatiquement après modification?
            autoSave: false, // Défaut

            // --- Définition des Actions ---
            // La clé (ex: 'save') doit correspondre aux noms dans th-actions="..."
            actions: {
                'save': {
                    // Requis: Fonction exécutée au clic
                    // Reçoit un objet 'context' avec { row, cell, tableHandler, data, source }
                    handler: (context) => {
                        // context.tableHandler est l'instance TableInstance
                        context.tableHandler.logger.info('Sauvegarde demandée pour ligne:', context.row.id);
                        context.tableHandler.logger.info('Données à sauvegarder:', context.data);
                        // Simuler un appel API asynchrone
                        context.tableHandler.notify('info', `Sauvegarde de ${context.data.colData1}...`); // Utilise le notificateur
                        setTimeout(() => {
                            // Marquer la ligne comme sauvegardée dans TableFlow
                            // Ceci met à jour data-initial-value et retire la classe 'modified'
                            context.tableHandler.markRowAsSaved(context.row);
                            context.tableHandler.notify('success', `Ligne ${context.row.id} sauvegardée !`);
                        }, 1000); // Simule délai réseau
                    },
                    // Surcharge showOnChange global: afficher ce bouton seulement si modifié
                    showOnChange: true,
                    // Optionnel: Remplacer l'icône par défaut
                    // icon: '&lt;svg&gt;...&lt;/svg&gt;'
                    label: 'Sauvegarder les changements' // Tooltip personnalisé
                },
                'delete': {
                    handler: (context) => {
                        context.tableHandler.logger.info('Suppression demandée pour ligne:', context.row.id);
                        // La confirmation est gérée par l'option 'confirm' ci-dessous
                        // Simuler suppression API
                        context.tableHandler.notify('info', `Suppression de ${context.data.colData1}...`);
                        setTimeout(() => {
                             // Supprimer la ligne de la table via l'API TableInstance
                             const success = context.tableHandler.removeRow(context.row);
                             if (success) {
                                 context.tableHandler.notify('success', `Ligne ${context.row.id} supprimée.`);
                             } else {
                                  context.tableHandler.notify('error', `Échec suppression ligne ${context.row.id}.`);
                             }
                        }, 500);
                    },
                    // Demander confirmation avant d'exécuter le handler
                    confirm: "Êtes-vous sûr de vouloir supprimer cette ligne définitivement ?" // Message personnalisé
                    // ou confirm: true pour utiliser le message par défaut si défini dans confirmMessages
                },
                'edit': { // Exemple: action non définie dans l'HTML de cet exemple
                    label: 'Modifier (externe)', // Tooltip
                    handler: (context) => {
                        alert(`Ouvrir modale d'édition pour ID: ${context.data.id || context.row.id}, Nom: ${context.data.colData1}`);
                        // openExternalEditModal(context.data);
                    }
                    // showOnChange: false (par défaut si non dans le tableau showOnChange global)
                },
                 'duplicate': { // Exemple: action non définie dans l'HTML de cet exemple
                    label: 'Dupliquer',
                    handler: (context) => {
                        const newData = { ...context.data };
                        // Retirer l'ID ou autres clés spécifiques avant d'ajouter
                        // delete newData.id; // Supposons que 'id' est la clé primaire
                        // delete newData.rowId; // Retirer rowId ajouté par getRowData
                        newData.colData1 = `${newData.colData1} (Copie)`;
                        context.tableHandler.addRow(newData); // Utilise l'API TableInstance
                        context.tableHandler.notify('success', `Ligne ${context.row.id} dupliquée.`);
                    },
                    confirm: true // Utilise le message par défaut (si défini) ou un message générique
                }
            },

            // --- Icônes par Défaut ---
            // Utilisées si action.icon n'est pas défini
            icons: {
                'save': '&lt;i class="fas fa-save" aria-hidden="true"&gt;&lt;/i&gt;', // FontAwesome
                'delete': '&lt;i class="fas fa-trash-alt" aria-hidden="true"&gt;&lt;/i&gt;',
                'edit': '&lt;i class="fas fa-pencil-alt" aria-hidden="true"&gt;&lt;/i&gt;',
                'duplicate': '&lt;i class="fas fa-copy" aria-hidden="true"&gt;&lt;/i&gt;'
            },

            // --- Messages de Confirmation par Défaut ---
            // Utilisés si action.confirm === true
            confirmMessages: {
                'delete': 'Confirmer la suppression ?',
                'duplicate': 'Dupliquer cette ligne ?'
                // Pas de message par défaut pour 'save' ou 'edit'
            }
        },
        edit: { /* ... config Edit ... */ }
    }
});
</code></pre>

                <h3>Tableau Complet des Options de Configuration JS (`plugins.actions`)</h3>
                <div class="info-block">
                    Ce tableau liste toutes les options configurables pour le plugin Actions via l'objet `plugins.actions`.
                </div>
                <table class="documentation-table">
                    <thead>
                        <tr><th>Option (dans `plugins.actions`)</th><th>Type</th><th>Défaut</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code class="attr">actionAttribute</code></td><td class="type">string</td><td><code class="default">'th-actions'</code></td><td>Nom de l'attribut HTML sur `<th>` pour définir les actions d'une colonne.</td></tr>
                        <tr><td><code class="attr">sqlExcludeAttribute</code></td><td class="type">string</td><td><code class="default">'th-sql-exclude'</code></td><td>Nom de l'attribut HTML sur `<th>` pour exclure une colonne des données récupérées par `getRowData()`.</td></tr>
                        <tr><td><code class="attr">cellClass</code></td><td class="type">string</td><td><code class="default">'td-actions'</code></td><td>Classe CSS ajoutée aux cellules `<td>` contenant les icônes/boutons d'action.</td></tr>
                        <tr><td><code class="attr">modifiedClass</code></td><td class="type">string</td><td><code class="default">'modified'</code></td><td>Classe CSS utilisée pour identifier les lignes modifiées (pertinent pour `showOnChange`).</td></tr>
                        <tr><td><code class="attr">useIcons</code></td><td class="type">boolean</td><td><code class="default">true</code></td><td>Si `true`, le plugin insère le HTML des icônes définies. Si `false`, il crée des boutons texte simples (classe `tf-action-button`).</td></tr>
                        <tr><td><code class="attr">debug</code></td><td class="type">boolean</td><td><code class="default">false</code></td><td>Active les logs de débogage spécifiques au plugin Actions. Hérite du `debug` global si non défini.</td></tr>
                        <tr><td><code class="attr">showOnChange</code></td><td class="type">boolean | Array&lt;string&gt;</td><td><code class="default">[]</code></td><td>Comportement par défaut pour afficher/masquer les actions si la ligne est modifiée. `true`: toutes les actions sont conditionnelles par défaut. `Array`: seules les actions listées sont conditionnelles par défaut. Peut être surchargé par `action.showOnChange`.</td></tr>
                        <tr><td><code class="attr">autoSave</code></td><td class="type">boolean</td><td><code class="default">false</code></td><td>Si `true`, l'action nommée 'save' (si elle existe) sera automatiquement appelée après un `cell:change` si la ligne est modifiée. Peut être surchargé par `actions.save.autoSave`.</td></tr>
                        <tr><td><code class="attr">actions</code></td><td class="type">object</td><td><code class="default">{}</code></td><td><strong>(Essentiel)</strong> Objet définissant chaque action possible. La clé est le nom de l'action (utilisé dans `th-actions`), la valeur est un objet décrivant l'action (voir tableau suivant).</td></tr>
                        <tr><td><code class="attr">icons</code></td><td class="type">object</td><td><code class="default">{}</code></td><td>Objet associant un nom d'action à son code HTML d'icône par défaut. Utilisé si `actions[nomAction].icon` n'est pas défini.</td></tr>
                        <tr><td><code class="attr">confirmMessages</code></td><td class="type">object</td><td><code class="default">{}</code></td><td>Objet associant un nom d'action à son message de confirmation par défaut. Utilisé si `actions[nomAction].confirm === true`.</td></tr>
                    </tbody>
                </table>

                 <h3>Structure Complète de Définition d'une Action (dans `plugins.actions.actions`)</h3>
                 <div class="info-block">
                    Ce tableau détaille toutes les propriétés possibles pour définir une action spécifique à l'intérieur de l'objet `plugins.actions.actions`.
                 </div>
                 <table class="documentation-table">
                     <thead>
                         <tr><th>Propriété (dans `actions[nomAction]`)</th><th>Type</th><th>Requis?</th><th>Description</th></tr>
                     </thead>
                     <tbody>
                         <tr><td><code class="attr">handler</code></td><td class="type">function</td><td>Oui</td><td>La fonction JavaScript à exécuter lorsque l'icône/bouton de l'action est cliqué. Reçoit un objet `context` en argument (voir section "Contexte du Handler"). Peut être `async`.</td></tr>
                         <tr><td><code class="attr">showOnChange</code></td><td class="type">boolean</td><td>Non</td><td>Si défini, surcharge le comportement global `showOnChange` pour cette action spécifique. `true`: visible seulement si ligne modifiée. `false`: toujours visible (sauf si masquée par `hideSpecificAction`). Si non défini, hérite du comportement global.</td></tr>
                         <tr><td><code class="attr">icon</code></td><td class="type">string</td><td>Non</td><td>Code HTML de l'icône pour cette action. Surcharge l'icône définie dans `plugins.actions.icons[nomAction]`. Si absent et `useIcons` est `true`, l'icône de `icons` est utilisée. Si aucune icône n'est trouvée et `useIcons` est `true`, rien n'est affiché (ou un bouton texte si `useIcons` est `false`). Le HTML est inséré via le sanitizer.</td></tr>
                         <tr><td><code class="attr">label</code></td><td class="type">string</td><td>Non</td><td>Texte utilisé pour l'attribut `title` de l'icône/bouton (tooltip) et comme texte si `useIcons` est `false` et `icon` n'est pas défini. Défaut: nom de l'action.</td></tr>
                         <tr><td><code class="attr">confirm</code></td><td class="type">boolean | string</td><td>Non</td><td>Si `true`, une confirmation (`window.confirm`) s'affiche avant d'exécuter le `handler`, utilisant le message de `confirmMessages[nomAction]` ou un message générique. Si c'est une chaîne non vide, cette chaîne est utilisée comme message de confirmation. Si `false` ou non défini, aucune confirmation n'est demandée.</td></tr>
                         <tr><td><code class="attr">autoSave</code></td><td class="type">boolean</td><td>Non</td><td>(Pertinent seulement si le nom de l'action est 'save') Si défini, surcharge le comportement global `autoSave`. `true`: cette action 'save' sera déclenchée automatiquement après `cell:change`. `false`: ne sera pas déclenchée automatiquement.</td></tr>
                     </tbody>
                 </table>
            </section>

            <section id="plugin-actions-handler-context">
                <h2>Contexte du Handler d'Action (`handler(context)`)</h2>
                <p>
                    La fonction `handler` que vous définissez pour chaque action reçoit un unique objet `context` contenant les informations et outils suivants :
                </p>
                 <table class="documentation-table">
                     <thead>
                         <tr><th>Propriété (dans `context`)</th><th>Type</th><th>Description</th></tr>
                     </thead>
                     <tbody>
                         <tr><td><code class="attr">row</code></td><td class="type">HTMLTableRowElement</td><td>L'élément `<tr>` de la ligne sur laquelle l'action a été cliquée.</td></tr>
                         <tr><td><code class="attr">cell</code></td><td class="type">HTMLTableCellElement</td><td>L'élément `<td>` de la cellule contenant l'icône/bouton d'action cliqué.</td></tr>
                         <tr><td><code class="attr">tableHandler</code></td><td class="type">TableInstance</td><td>L'instance de `TableInstance` gérant le tableau. Permet d'accéder à l'API Core (ex: `context.tableHandler.markRowAsSaved(context.row)`, `context.tableHandler.removeRow(context.row)`, `context.tableHandler.notify(...)`, `context.tableHandler.logger`, `context.tableHandler.getRowData(context.row)`).</td></tr>
                         <tr><td><code class="attr">data</code></td><td class="type">object</td><td>Un objet contenant les données actuelles de la ligne, collectées juste avant l'appel du handler via `tableHandler.getRowData()`. Les clés sont les IDs des `<th>` (non exclus par `th-sql-exclude`), les valeurs sont les `data-value` (ou texte) des cellules. Inclut `rowId: row.id` si la ligne a un ID.</td></tr>
                         <tr><td><code class="attr">source</code></td><td class="type">string</td><td>Indique comment l'action a été déclenchée. `'manual'` pour un clic utilisateur, `'autoSave'` si déclenchée par l'option `autoSave`.</td></tr>
                     </tbody>
                 </table>
                 <div class="info-block">
                    <strong>Utilisation de `tableHandler` :</strong> L'accès à `context.tableHandler` est crucial pour interagir avec l'état de la table après votre logique métier (ex: après un appel API réussi). Utilisez `markRowAsSaved` pour indiquer que les modifications sont persistées et `removeRow` pour supprimer la ligne de l'interface.
                 </div>
            </section>

            <section id="plugin-actions-how-it-works">
                <h2>Fonctionnement Interne</h2>
                <ul>
                    <li><strong>Initialisation (`init`, `setupActionColumns`, `setupActionCell`):</strong> Identifie les colonnes `th-actions`. Pour chaque cellule `<td>` correspondante, insère les éléments HTML (icônes ou boutons) pour chaque action listée, en appliquant l'état de visibilité initial (`showOnChange`). Attache un écouteur de clic délégué au `tbody`.</li>
                    <li><strong>Clic sur une Action (`_clickHandler` -> `executeAction`):</strong> L'écouteur délégué intercepte le clic, identifie l'action via `data-action`. Appelle `executeAction` qui gère la confirmation éventuelle, récupère les données de la ligne via `tableHandler.getRowData()`, crée l'objet `context`, et appelle le `handler` configuré pour cette action.</li>
                    <li><strong>Gestion des Modifications (`handleCellChange`):</strong> Écoute l'événement `cell:change`. Vérifie si la ligne est modifiée (via `event.detail.isModified` ou `tableHandler.isRowModified`). Met à jour la classe `modifiedClass` sur la `<tr>`. Appelle `updateActionButtons()` pour ajuster la visibilité des boutons conditionnels. Si `autoSave` est activé et la ligne est modifiée, déclenche l'action 'save'.</li>
                    <li><strong>Gestion de la Sauvegarde (`handleRowSaved`) :</strong> Écoute l'événement `row:saved` (déclenché par `tableHandler.markRowAsSaved`). Retire la classe `modifiedClass`. Appelle `updateActionButtons()` pour masquer les boutons `showOnChange`. Peut masquer une action spécifique si l'option `hideAction` est passée via les options de `markRowAsSaved`.</li>
                    <li><strong>Gestion des Nouvelles Lignes (`handleRowAdded`):</strong> Écoute `row:added`. Appelle `setupActionColumns(newRow)` pour ajouter les boutons à la nouvelle ligne et `updateActionButtons()` pour définir leur état initial.</li>
                    <li><strong>Mise à Jour des Boutons (`updateActionButtons`):</strong> Modifie le style `display` des éléments d'action dans une ligne en fonction de l'état `modified` de la ligne et de l'option `showOnChange` de chaque action.</li>
                    <li><strong>Nettoyage (`destroy`):</strong> Supprime les écouteurs d'événements (`cell:change`, `row:saved`, `row:added`, et le clic délégué).</li>
                </ul>
            </section>

            <section id="plugin-actions-events">
                <h2>Événements</h2>
                <ul>
                    <li><strong>Écoutés :</strong>
                        <ul>
                            <li><code>click</code> (sur `tbody`, délégué) : Pour détecter les clics sur les éléments d'action.</li>
                            <li><code>cell:change</code> (sur la table) : Pour détecter les modifications et mettre à jour l'état `modified` et la visibilité des boutons.</li>
                            <li><code>row:saved</code> (sur la table) : Pour réinitialiser l'état `modified` et la visibilité des boutons après une sauvegarde.</li>
                            <li><code>row:added</code> (sur la table) : Pour initialiser les boutons sur les nouvelles lignes.</li>
                        </ul>
                    </li>
                    <li><strong>Déclenchés :</strong> Aucun événement spécifique déclenché par ce plugin lui-même (il déclenche des actions via les handlers). Les handlers peuvent déclencher d'autres événements ou appeler l'API TableFlow.</li>
                </ul>
            </section>

            <section id="plugin-actions-example">
                <h2>Exemple Complet</h2>
                <p>Cet exemple montre une table d'utilisateurs avec une colonne éditable et une colonne d'actions pour sauvegarder les modifications ou supprimer un utilisateur.</p>

                <strong>HTML (`index.html`):</strong>
                <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Exemple Actions Plugin&lt;/title&gt;
    &lt;link rel="stylesheet" href="../src/tableFlow.css"&gt;
    &lt;link rel="stylesheet" href="documentation.css"&gt;
    &lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"&gt;
    &lt;style&gt;
        body { padding: 2rem; font-family: sans-serif; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        thead th { background-color: #f2f2f2; }
        tr.modified td { background-color: #fffbeb; }
        td.td-actions .cell-wrapper { display: flex; gap: 10px; justify-content: center; align-items: center; }
        td.td-actions [data-action] { font-size: 1.1em; cursor: pointer; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;TableFlow - Exemple Plugin Actions&lt;/h1&gt;
    &lt;p&gt;Double-cliquez sur le nom ou l'email pour éditer. L'icône de sauvegarde apparaît après modification.&lt;/p&gt;

    &lt;table id="userTableActions"&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th id="userId" th-hide&gt;ID&lt;/th&gt; &lt;!-- Masqué --&gt;
                &lt;th id="userName" th-edit&gt;Nom&lt;/th&gt;
                &lt;th id="userEmail" th-edit&gt;Email&lt;/th&gt;
                &lt;th id="userActions" th-actions="save,delete"&gt;Actions&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
            &lt;tr id="1"&gt;
                &lt;td id="userId_1"&gt;1&lt;/td&gt;
                &lt;td id="userName_1"&gt;Alice&lt;/td&gt;
                &lt;td id="userEmail_1"&gt;alice@example.com&lt;/td&gt;
                &lt;td id="userActions_1"&gt;&lt;/td&gt; &lt;!-- Sera rempli par le plugin --&gt;
            &lt;/tr&gt;
            &lt;tr id="2"&gt;
                &lt;td id="userId_2"&gt;2&lt;/td&gt;
                &lt;td id="userName_2"&gt;Bob&lt;/td&gt;
                &lt;td id="userEmail_2"&gt;bob@sample.net&lt;/td&gt;
                &lt;td id="userActions_2"&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;

    &lt;script type="module"&gt;
        import TableFlow from '../src/tableFlow.js'; // Ajustez le chemin

        const userTable = new TableFlow({
            tableId: 'userTableActions',
            pluginsPath: '../plugins', // Ajustez
            debug: true, // Activer les logs pour le débogage
            plugins: {
                // Activer les plugins nécessaires
                names: ['Edit', 'Actions', 'Hide'],
                actions: {
                    // Définir les handlers pour les actions 'save' et 'delete'
                    actions: {
                        'save': {
                            handler: (context) => {
                                console.log('Handler SAVE appelé pour:', context.row.id);
                                console.log('Données:', context.data);
                                // Simuler un appel API de sauvegarde
                                context.tableHandler.notify('info', `Sauvegarde de ${context.data.userName}...`);
                                setTimeout(() => {
                                    // Marquer la ligne comme sauvegardée dans TableFlow
                                    context.tableHandler.markRowAsSaved(context.row);
                                    context.tableHandler.notify('success', `Utilisateur ${context.data.userName} sauvegardé !`);
                                }, 800); // Simule délai
                            },
                            showOnChange: true // Afficher seulement si modifié
                        },
                        'delete': {
                            handler: (context) => {
                                console.log('Handler DELETE appelé pour:', context.row.id);
                                // La confirmation est gérée par l'option 'confirm'
                                context.tableHandler.notify('info', `Suppression de ${context.data.userName}...`);
                                setTimeout(() => {
                                    // Supprimer la ligne via l'API TableInstance
                                    const success = context.tableHandler.removeRow(context.row);
                                    if (success) {
                                        context.tableHandler.notify('success', `Utilisateur ${context.data.userName} supprimé.`);
                                    } else {
                                         context.tableHandler.notify('error', `Échec suppression ligne ${context.row.id}.`);
                                    }
                                }, 500);
                            },
                            confirm: "Voulez-vous vraiment supprimer cet utilisateur ?" // Message personnalisé
                        }
                    },
                    // Définir les icônes (FontAwesome)
                    icons: {
                        'save': '&lt;i class="fas fa-save" style="color: green;" aria-hidden="true"&gt;&lt;/i&gt;',
                        'delete': '&lt;i class="fas fa-trash-alt" style="color: red;" aria-hidden="true"&gt;&lt;/i&gt;'
                    }
                },
                edit: { /* Config par défaut suffit */ },
                hide: { /* Pas de config nécessaire */ }
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

                <strong>Fonctionnement de l'exemple :</strong>
                <ol>
                    <li>La table s'affiche avec les colonnes "Nom" et "Email" éditables. L'ID est masqué.</li>
                    <li>La colonne "Actions" contient initialement seulement l'icône de suppression (corbeille rouge) car l'action 'save' a `showOnChange: true`.</li>
                    <li>Si vous modifiez une cellule (ex: le nom d'Alice), la ligne devient jaune pâle (classe `modified`) et l'icône de sauvegarde (disquette verte) apparaît à côté de la corbeille.</li>
                    <li>Si vous cliquez sur la disquette, le handler 'save' est exécuté. Une notification simule la sauvegarde, puis `markRowAsSaved` est appelé. La ligne redevient blanche, et l'icône de sauvegarde disparaît.</li>
                    <li>Si vous cliquez sur la corbeille, une boîte de dialogue de confirmation apparaît. Si vous confirmez, le handler 'delete' est exécuté, une notification simule la suppression, et `removeRow` retire la ligne du tableau.</li>
                </ol>
            </section>

        </div>
    </div>
</body>
</html>
