<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation Plugin ColumnReorder - TableFlow</title>
    <link rel="stylesheet" href="documentation.css">
    <link rel="stylesheet" href="../src/tableFlow.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Styles spécifiques à cette page */
        body { padding: 2rem; }
        .content { margin-left: 0; } /* Pas de nav latérale */
         h1 { margin-bottom: 2rem; }
         /* Style pour la cohérence (ligne modifiée) */
         tr.modified td { background-color: var(--tf-modified-bg, #fffbeb); }

         /* Styles pour ColumnReorder (normalement dans tableFlow.css) */
         th.reorderable-column { position: relative; cursor: grab; }
         .column-header-container { display: flex; align-items: center; width: 100%; position: relative; }
         .column-drag-handle { cursor: grab; color: var(--tf-reorder-handle-color, #999); transition: color 0.2s ease; padding: 0 5px; touch-action: none; flex-shrink: 0; }
         .column-drag-handle:hover { color: var(--tf-reorder-handle-hover-color, #333); }
         th.column-dragging { opacity: 0.5; cursor: grabbing !important; }
         .column-drop-indicator { position: fixed; width: 4px; background-color: var(--tf-reorder-indicator-color, #4f46e5); z-index: 1000; pointer-events: none; transition: left 0.1s ease-out, top 0.1s ease-out; box-shadow: 0 0 5px rgba(79, 70, 229, 0.5); display: none; }
         body > .column-reorder-ghost { position: fixed; left: 0; top: 0; z-index: 1001; pointer-events: none; transition: none; box-shadow: 0 4px 8px rgba(0,0,0,0.2); background: var(--tf-bg-color, #fff); cursor: grabbing !important; border: 1px solid var(--tf-border-color, #ccc); }
         body.user-select-none { user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">
            <h1>Documentation Plugin ColumnReorder</h1>

            <section id="plugin-colreorder-intro">
                <h2>Objectif</h2>
                <p>
                    Le plugin <strong>ColumnReorder</strong> permet aux utilisateurs de modifier l'ordre des colonnes d'un tableau TableFlow par glisser-déposer (drag and drop) des en-têtes de colonnes (`<th>`).
                </p>
                <p>
                    Il ajoute une "poignée" visuelle (configurable) aux en-têtes des colonnes réorganisables, fournit un indicateur visuel pendant le glissement pour montrer où la colonne sera déposée, et réorganise physiquement les cellules (`<th>`, `<td>`) dans le DOM pour refléter le nouvel ordre.
                </p>
                <p>
                    Le plugin peut également sauvegarder l'ordre des colonnes choisi par l'utilisateur dans le `localStorage` du navigateur, afin de le restaurer lors des visites ultérieures de la page.
                </p>
                 <div class="warning-block">
                    <strong>Limitation Connue :</strong> La version actuelle du plugin ne gère <strong>pas</strong> correctement les en-têtes de colonnes qui utilisent les attributs `colspan` ou `rowspan`. L'utilisation de ce plugin sur des tableaux avec de tels en-têtes peut entraîner un comportement inattendu ou une rupture de la mise en page.
                 </div>
            </section>

            <section id="plugin-colreorder-activation">
                <h2>Activation et Configuration HTML</h2>
                <p>
                    Ce plugin est généralement activé via la configuration JavaScript (`plugins.names: ['ColumnReorder', ...]`). Il ne nécessite <strong>aucun attribut spécifique</strong> sur les `<th>` pour être activé globalement sur la table.
                </p>
                <p>
                    Par défaut, toutes les colonnes sont considérées comme réorganisables. Vous pouvez <strong>exclure</strong> spécifiquement certaines colonnes de la réorganisation en leur ajoutant un attribut ou une classe CSS qui correspond au sélecteur défini dans l'option JavaScript <code class="attr">excludeSelector</code> (par défaut: `[th-noreorder], [th-actions], [th-hide]`).
                </p>
                <pre><code class="language-html">&lt;table id="maTableReorder"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th id="colFixe" th-noreorder&gt;ID Fixe&lt;/th&gt; &lt;!-- Exclu par défaut via [th-noreorder] --&gt;
      &lt;th id="colA"&gt;Colonne A (Réorganisable)&lt;/th&gt;
      &lt;th id="colB"&gt;Colonne B (Réorganisable)&lt;/th&gt;
      &lt;th id="colC" class="no-drag"&gt;Colonne C (Exclue via classe CSS si configuré)&lt;/th&gt;
      &lt;th id="colActions" th-actions="save"&gt;Actions (Exclue par défaut via [th-actions])&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;!-- ... lignes ... --&gt;
  &lt;/tbody&gt;
&lt;/table&gt;</code></pre>
                <p>
                    Dans cet exemple :
                </p>
                <ul>
                    <li>La colonne "ID Fixe" ne sera pas réorganisable car elle a l'attribut `th-noreorder`.</li>
                    <li>Les colonnes A et B seront réorganisables.</li>
                    <li>La colonne C sera réorganisable <em>sauf si</em> vous modifiez l'option `excludeSelector` en JS pour inclure `.no-drag`.</li>
                    <li>La colonne Actions sera exclue par défaut car elle correspond à `[th-actions]`.</li>
                </ul>
                <p>
                    Le plugin ajoutera automatiquement une poignée de glissement (configurée par `handleHTML` et `handleSelector`) aux en-têtes réorganisables.
                </p>
            </section>

            <section id="plugin-colreorder-config-js">
                <h2>Configuration JavaScript</h2>
                <p>
                    La configuration détaillée du plugin se fait dans l'objet d'options de `TableFlow`, sous la clé <code class="value">plugins.columnreorder</code>.
                </p>
                <pre><code class="language-javascript">// Exemple d'initialisation de TableFlow
import TableFlow from '../src/tableFlow.js'; // Ajustez le chemin

const tableRO = new TableFlow({
    tableId: 'maTableReorder',
    pluginsPath: '../plugins', // Ajustez
    debug: true,
    plugins: {
        names: ['ColumnReorder'], // Activer le plugin
        columnreorder: { // Configuration spécifique
            // --- Options Générales ---
            enabled: true, // Activer/désactiver le plugin (défaut: true)
            // debug: true, // Logs spécifiques

            // --- Apparence et Interaction ---
            handleSelector: '.ma-poignee-perso', // Sélecteur pour votre poignée personnalisée
            handleHTML: '&lt;span class="ma-poignee-perso" title="Réorganiser"&gt;☰&lt;/span&gt;', // HTML de votre poignée
            handlePosition: 'append', // Ajouter la poignée à la fin du contenu de l'en-tête
            reorderableClass: 'draggable-header', // Classe CSS pour les <th> réorganisables
            draggingClass: 'header-is-dragging', // Classe CSS pendant le glissement
            dropIndicatorClass: 'drop-here-indicator', // Classe CSS pour l'indicateur de dépôt
            headerContainerClass: 'th-content-wrapper', // Classe du conteneur interne ajouté
            dragImageOpacity: 0.6, // Rendre l'élément fantôme plus transparent

            // --- Exclusion ---
            // Exclure les colonnes ayant la classe 'no-drag' en plus des défauts
            excludeSelector: '[th-noreorder], [th-actions], [th-hide], .no-drag',

            // --- Persistance ---
            persistOrder: true, // Activer la sauvegarde (défaut: true)
            // storageKey: 'customOrderKeyForMyTable', // Clé personnalisée pour localStorage
            resetOnDestroy: false, // Ne pas réinitialiser l'ordre à la destruction (défaut)

            // --- Callbacks ---
            onColumnReorder: (details) => {
                console.log('Colonnes réorganisées !', details);
                // details = { from, to, columnId, originalIndex, newOrder }
                // 'from' et 'to' sont les index *actuels* avant/après déplacement
                // 'originalIndex' est l'index DOM initial de la colonne déplacée
                // 'newOrder' est le nouveau tableau columnOrder (indices originaux)
            },
            onDragStart: (details) => {
                console.log('Début du drag:', details.columnId);
                // details = { columnId, index, originalIndex, element }
            },
            onDragEnd: (details) => {
                console.log('Fin du drag:', details);
                // details = { sourceIndex, targetIndex, newOrder }
                // sourceIndex/targetIndex sont les index *actuels* (-1 si drop invalide)
            }
        }
    }
});
</code></pre>

                <h3>Tableau Complet des Options de Configuration JS (`plugins.columnreorder`)</h3>
                <div class="info-block">
                    Ce tableau liste toutes les options configurables pour le plugin ColumnReorder via l'objet `plugins.columnreorder`.
                </div>
                <table class="documentation-table">
                    <thead>
                        <tr><th>Option</th><th>Type</th><th>Défaut</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code class="attr">enabled</code></td><td class="type">boolean</td><td><code class="default">true</code></td><td>Active ou désactive complètement le plugin.</td></tr>
                        <tr><td><code class="attr">handleSelector</code></td><td class="type">string</td><td><code class="default">'.column-drag-handle'</code></td><td>Sélecteur CSS utilisé pour identifier l'élément (la "poignée") dans l'en-tête qui initie le glisser-déposer. Doit correspondre à l'élément racine de `handleHTML`.</td></tr>
                        <tr><td><code class="attr">handleHTML</code></td><td class="type">string</td><td><code class="default">'&lt;div class="column-drag-handle" ...&gt;&lt;i class="fas fa-grip-vertical"&gt;&lt;/i&gt;&lt;/div&gt;'</code></td><td>Code HTML de la poignée à insérer dans les en-têtes réorganisables. L'élément racine doit correspondre à `handleSelector`.</td></tr>
                        <tr><td><code class="attr">handlePosition</code></td><td class="type">string</td><td><code class="default">'prepend'</code></td><td>Où insérer `handleHTML` par rapport au contenu existant de l'en-tête : `'prepend'` (avant), `'append'` (après), ou `'replace'` (remplace tout le contenu).</td></tr>
                        <tr><td><code class="attr">reorderableClass</code></td><td class="type">string</td><td><code class="default">'reorderable-column'</code></td><td>Classe CSS ajoutée aux éléments `<th>` qui sont réorganisables.</td></tr>
                        <tr><td><code class="attr">draggingClass</code></td><td class="type">string</td><td><code class="default">'column-dragging'</code></td><td>Classe CSS ajoutée à l'élément `<th>` pendant qu'il est glissé.</td></tr>
                        <tr><td><code class="attr">dropIndicatorClass</code></td><td class="type">string</td><td><code class="default">'column-drop-indicator'</code></td><td>Classe CSS appliquée à l'élément `<div>` qui sert d'indicateur visuel de la position de dépôt.</td></tr>
                        <tr><td><code class="attr">headerContainerClass</code></td><td class="type">string</td><td><code class="default">'column-header-container'</code></td><td>Classe CSS ajoutée au conteneur `<div>` interne créé dans les `<th>` réorganisables pour contenir le contenu original et la poignée.</td></tr>
                        <tr><td><code class="attr">excludeSelector</code></td><td class="type">string</td><td><code class="default">'[th-noreorder], [th-actions], [th-hide]'</code></td><td>Sélecteur CSS pour identifier les `<th>` à exclure de la réorganisation. Les sélecteurs sont séparés par des virgules.</td></tr>
                        <tr><td><code class="attr">persistOrder</code></td><td class="type">boolean</td><td><code class="default">true</code></td><td>Si `true`, l'ordre des colonnes est sauvegardé dans `localStorage` et restauré au prochain chargement.</td></tr>
                        <tr><td><code class="attr">storageKey</code></td><td class="type">string</td><td><code class="default">null</code></td><td>Clé utilisée pour `localStorage`. Si `null` et `persistOrder` est `true`, une clé est générée automatiquement (`tableId_columnOrder`).</td></tr>
                        <tr><td><code class="attr">dragImageOpacity</code></td><td class="type">number</td><td><code class="default">0.7</code></td><td>Opacité (entre 0 et 1) de l'élément "fantôme" qui suit le curseur pendant le glissement.</td></tr>
                        <tr><td><code class="attr">resetOnDestroy</code></td><td class="type">boolean</td><td><code class="default">false</code></td><td>Si `true`, l'ordre des colonnes sera réinitialisé à l'ordre original lorsque le plugin ou l'instance TableFlow est détruit(e).</td></tr>
                        <tr><td><code class="attr">onColumnReorder</code></td><td class="type">function</td><td><code class="default">null</code></td><td>Callback exécuté <strong>après</strong> qu'une colonne a été réorganisée avec succès. Reçoit un objet `{ from, to, columnId, originalIndex, newOrder }`.</td></tr>
                        <tr><td><code class="attr">onDragStart</code></td><td class="type">function</td><td><code class="default">null</code></td><td>Callback exécuté au <strong>début</strong> du glissement d'une colonne. Reçoit un objet `{ columnId, index, originalIndex, element }`.</td></tr>
                        <tr><td><code class="attr">onDragEnd</code></td><td class="type">function</td><td><code class="default">null</code></td><td>Callback exécuté à la <strong>fin</strong> du glissement (que la colonne ait été déplacée ou non). Reçoit un objet `{ sourceIndex, targetIndex, newOrder }`. `targetIndex` est `-1` si le dépôt était invalide.</td></tr>
                        <tr><td><code class="attr">debug</code></td><td class="type">boolean</td><td><code class="default">false</code></td><td>Active les logs de débogage spécifiques à ce plugin. Hérite du `debug` global si non défini.</td></tr>
                    </tbody>
                </table>
            </section>

            <section id="plugin-colreorder-how-it-works">
                <h2>Fonctionnement Interne</h2>
                <ul>
                    <li><strong>Initialisation (`init`, `analyzeTableStructure`, `setupDragHandles`):</strong>
                        <ul>
                            <li>Analyse les `<th>` de la première ligne de `<thead>` (`analyzeTableStructure`), stocke leurs infos (élément, index original, ID, réorganisable?) dans `state.headerElements`.</li>
                            <li>Initialise `state.columnOrder` avec les indices originaux (`[0, 1, 2, ...]`) et sauvegarde cet ordre dans `state.originalOrder`.</li>
                            <li>Charge l'ordre depuis `localStorage` (`loadColumnOrder`) si `persistOrder` est `true` et que l'ordre sauvegardé est valide (même nombre de colonnes, mêmes IDs). Applique cet ordre au DOM via `applyColumnOrder`.</li>
                            <li>Pour chaque `<th>` réorganisable, crée un conteneur interne (`headerContainerClass`), y déplace le contenu original, et y insère la poignée (`handleHTML`) selon `handlePosition` (`setupDragHandles`). Ajoute la classe `reorderableClass`.</li>
                            <li>Crée l'élément `<div>` indicateur de dépôt (`createDropIndicator`) et l'ajoute au `body` (caché).</li>
                            <li>Attache les écouteurs d'événements (`setupEventListeners`) pour `mousedown`/`touchstart` sur la table, et `mousemove`/`touchmove`/`mouseup`/`touchend` sur `document`.</li>
                            <li>Configure un `MutationObserver` (`setupMutationObserver`) pour détecter les changements structurels et appeler `refresh()`.</li>
                        </ul>
                    </li>
                    <li><strong>Début du Glissement (`handleMouseDown`/`handleTouchStart` -> `startDrag`):</strong>
                        <ul>
                            <li>Détecte un appui sur une poignée (`handleSelector`).</li>
                            <li>Empêche le comportement par défaut (sélection texte, scroll).</li>
                            <li>Marque `state.isDragging = true`, stocke le `<th>` glissé (`draggedColumn`), son index *actuel* (`draggedIndex`) et son index *original* (`draggedOriginalIndex`).</li>
                            <li>Ajoute la classe `draggingClass` au `<th>` et `user-select-none` au `body`.</li>
                            <li>Crée et affiche l'élément fantôme (`createGhostElement`).</li>
                            <li>Appelle le callback `onDragStart`.</li>
                        </ul>
                    </li>
                    <li><strong>Pendant le Glissement (`handleMouseMove`/`handleTouchMove`):</strong>
                        <ul>
                            <li>Si `isDragging` est `true`, déplace l'élément fantôme pour suivre le curseur/doigt (`moveGhostElement` via `transform`).</li>
                            <li>Calcule la position potentielle de dépôt (`updateDropPosition`) en comparant la position X du curseur avec le milieu des autres en-têtes réorganisables (dans l'ordre DOM actuel).</li>
                            <li>Affiche ou masque l'indicateur de dépôt (`showDropIndicator`/`hideDropIndicator`) à la position valide la plus proche (mais pas sur la colonne elle-même ou juste après). Stocke l'index de dépôt valide dans `state.currentDropIndex`.</li>
                        </ul>
                    </li>
                    <li><strong>Fin du Glissement (`handleMouseUp`/`handleTouchEnd` -> `finishDrag`):</strong>
                        <ul>
                            <li>Si `isDragging` est `true` et `currentDropIndex` est valide (différent de -1), appelle `reorderColumns(draggedIndex, currentDropIndex)`.</li>
                            <li>Nettoie l'état du glissement (`cleanupDragState`) : supprime fantôme, indicateur, classes CSS.</li>
                            <li>Appelle le callback `onDragEnd`.</li>
                        </ul>
                    </li>
                    <li><strong>Réorganisation (`reorderColumns` -> `applyColumnOrder`):</strong>
                        <ul>
                            <li>Met à jour le tableau `state.columnOrder` (qui contient les indices *originaux* dans le nouvel ordre).</li>
                            <li>Appelle `applyColumnOrder` pour modifier le DOM.</li>
                            <li>Sauvegarde le nouvel ordre dans `localStorage` si `persistOrder` est `true`.</li>
                            <li>Appelle le callback `onColumnReorder` et déclenche l'événement `column:reordered`.</li>
                        </ul>
                    </li>
                    <li><strong>Modification du DOM (`applyColumnOrder`):</strong>
                        <ul>
                            <li>Itère sur chaque section (`thead`, `tbody`, `tfoot`) et chaque ligne (`<tr>`).</li>
                            <li>Pour chaque ligne, déplace les cellules `<td>` ou `<th>` existantes pour correspondre au nouvel ordre défini dans `state.columnOrder`. Utilise un `DocumentFragment` pour l'efficacité.</li>
                            <li>Après modification du DOM, appelle `analyzeTableStructure()` et `setupDragHandles()` pour mettre à jour les références internes et les poignées.</li>
                        </ul>
                    </li>
                     <li><strong>Rafraîchissement (`refresh`):</strong> Ré-analyse la structure, recharge/applique l'ordre (si persistant), et reconfigure les poignées. Utile si le DOM est modifié par un autre script.</li>
                     <li><strong>Nettoyage (`destroy`):</strong> Supprime les écouteurs, l'indicateur, les poignées, les classes, déconnecte l'observer, et réinitialise l'état. Peut optionnellement réinitialiser l'ordre (`resetOnDestroy`).</li>
                </ul>
            </section>

            <section id="plugin-colreorder-api">
                 <h2>API Publique</h2>
                 <p>Le plugin expose quelques méthodes pour interagir avec l'ordre des colonnes par programmation.</p>
                 <pre><code class="language-javascript">// Obtenir l'instance du plugin (après initialisation de TableFlow)
const myTableFlowInstance = new TableFlow({ tableId: 'maTableReorder', /* ... */ });
await myTableFlowInstance.ready(); // Attendre l'initialisation
const reorderPlugin = myTableFlowInstance.getPlugin('columnreorder');

if (reorderPlugin) {
    // Obtenir l'ordre actuel (tableau des indices originaux)
    const currentOrder = reorderPlugin.getColumnOrder();
    console.log('Ordre actuel:', currentOrder); // Ex: [2, 0, 1]

    // Définir un nouvel ordre (doit contenir tous les indices originaux valides)
    try {
        reorderPlugin.setColumnOrder([1, 2, 0]); // Déplacer colonne 1 en premier
    } catch (error) {
        console.error("Erreur lors de la définition de l'ordre:", error);
    }

    // Réinitialiser à l'ordre original
    reorderPlugin.resetColumnOrder();

    // Activer/Désactiver le plugin
    reorderPlugin.setEnabled(false); // Désactiver le drag & drop
    reorderPlugin.setEnabled(true); // Réactiver

    // Vérifier si une colonne est réorganisable (par son index original)
    const canReorderCol0 = reorderPlugin.isColumnReorderable(0);
    console.log('Colonne index 0 réorganisable ?', canReorderCol0);
}
</code></pre>
                 <table class="documentation-table">
                     <thead>
                         <tr><th>Méthode</th><th>Arguments</th><th>Description</th><th>Retour</th></tr>
                     </thead>
                     <tbody>
                         <tr><td><code>getColumnOrder()</code></td><td>-</td><td>Retourne l'ordre actuel des colonnes sous forme d'un tableau contenant les indices <strong>originaux</strong> des colonnes.</td><td class="type">Array&lt;number&gt;</td></tr>
                         <tr><td><code>setColumnOrder(newOrder, persist)</code></td><td><code class="attr">newOrder</code> <span class="type">(Array&lt;number&gt;)</span><br><code class="attr">persist</code> <span class="type">(boolean, optionnel)</span></td><td>Définit un nouvel ordre pour les colonnes. `newOrder` doit être un tableau contenant tous les indices originaux valides dans l'ordre souhaité. Lève une erreur si l'ordre est invalide. Si `persist` est `true` (défaut) et que la persistance est activée, sauvegarde le nouvel ordre.</td><td class="type">void</td></tr>
                         <tr><td><code>resetColumnOrder()</code></td><td>-</td><td>Réinitialise l'ordre des colonnes à celui d'origine (tel qu'il était lors de l'initialisation) et supprime l'ordre sauvegardé dans localStorage.</td><td class="type">void</td></tr>
                         <tr><td><code>refresh()</code></td><td>-</td><td>Ré-analyse la structure de la table, recharge/applique l'ordre si nécessaire, et reconfigure les poignées. Utile après des modifications externes du DOM.</td><td class="type">void</td></tr>
                         <tr><td><code>setEnabled(enabled)</code></td><td><code class="attr">enabled</code> <span class="type">(boolean)</span></td><td>Active ou désactive dynamiquement la fonctionnalité de réorganisation.</td><td class="type">void</td></tr>
                         <tr><td><code>isColumnReorderable(originalIndex)</code></td><td><code class="attr">originalIndex</code> <span class="type">(number)</span></td><td>Vérifie si la colonne correspondant à l'index original donné est actuellement réorganisable (non exclue par `excludeSelector`).</td><td class="type">boolean</td></tr>
                     </tbody>
                 </table>
            </section>

            <section id="plugin-colreorder-events">
                <h2>Événements</h2>
                <ul>
                    <li><strong>Écoutés :</strong>
                        <ul>
                            <li><code>mousedown</code> / <code>touchstart</code> (sur la table) : Pour initier le glissement sur une poignée.</li>
                            <li><code>mousemove</code> / <code>touchmove</code> (sur `document`) : Pour suivre le déplacement et mettre à jour le fantôme/indicateur.</li>
                            <li><code>mouseup</code> / <code>touchend</code> / <code>touchcancel</code> (sur `document`) : Pour terminer le glissement.</li>
                            <li><code>row:added</code> / <code>row:removed</code> (sur la table) : Pour déclencher un `refresh`.</li>
                        </ul>
                    </li>
                    <li><strong>Déclenchés :</strong>
                        <ul>
                            <li><code>column:reordered</code> (sur l'élément `<table>`) : Déclenché après une réorganisation réussie. Contient `{ detail: { from, to, columnId, originalIndex, newOrder, tableId } }`.</li>
                            <li>(Indirectement) Les callbacks `onDragStart`, `onDragEnd`, `onColumnReorder` sont appelés s'ils sont fournis dans la configuration.</li>
                        </ul>
                    </li>
                </ul>
            </section>

            <section id="plugin-colreorder-example">
                <h2>Exemple Complet</h2>
                <p>Cet exemple montre une table simple où les colonnes "Nom" et "Ville" peuvent être réorganisées. L'ordre est sauvegardé.</p>

                <strong>HTML (`index.html`):</strong>
                <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Exemple ColumnReorder Plugin&lt;/title&gt;
    &lt;link rel="stylesheet" href="../src/tableFlow.css"&gt;
    &lt;link rel="stylesheet" href="documentation.css"&gt;
    &lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"&gt;
    &lt;style&gt;
        body { padding: 2rem; font-family: sans-serif; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        thead th { background-color: #f2f2f2; }
        /* Styles ColumnReorder (normalement dans tableFlow.css) */
        th.reorderable-column{position:relative;cursor:grab}
        .column-header-container{display:flex;align-items:center;width:100%;position:relative}
        .column-drag-handle{cursor:grab;color:#999;transition:color .2s ease;padding:0 5px;touch-action:none;flex-shrink:0}
        .column-drag-handle:hover{color:#333}
        th.column-dragging{opacity:.5;cursor:grabbing!important}
        .column-drop-indicator{position:fixed;width:4px;background-color:#4f46e5;z-index:1000;pointer-events:none;transition:left .1s ease-out,top .1s ease-out;box-shadow:0 0 5px rgba(79,70,229,.5);display:none}
        body>.column-reorder-ghost{position:fixed;left:0;top:0;z-index:1001;pointer-events:none;transition:none;box-shadow:0 4px 8px rgba(0,0,0,.2);background:#fff;cursor:grabbing!important;border:1px solid #ccc}
        body.user-select-none{user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;TableFlow - Exemple Plugin ColumnReorder&lt;/h1&gt;
    &lt;p&gt;Cliquez et glissez les icônes <i class="fas fa-grip-vertical"></i> dans les en-têtes pour réorganiser les colonnes.&lt;/p&gt;

    &lt;table id="reorderExampleTable"&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th id="colId" th-noreorder&gt;ID&lt;/th&gt; &lt;!-- Non réorganisable --&gt;
                &lt;th id="colName"&gt;Nom&lt;/th&gt;
                &lt;th id="colCity"&gt;Ville&lt;/th&gt;
                &lt;th id="colCountry"&gt;Pays&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
            &lt;tr id="r1"&gt;&lt;td id="colId_r1"&gt;1&lt;/td&gt;&lt;td id="colName_r1"&gt;Alice&lt;/td&gt;&lt;td id="colCity_r1"&gt;Paris&lt;/td&gt;&lt;td id="colCountry_r1"&gt;France&lt;/td&gt;&lt;/tr&gt;
            &lt;tr id="r2"&gt;&lt;td id="colId_r2"&gt;2&lt;/td&gt;&lt;td id="colName_r2"&gt;Bob&lt;/td&gt;&lt;td id="colCity_r2"&gt;Londres&lt;/td&gt;&lt;td id="colCountry_r2"&gt;UK&lt;/td&gt;&lt;/tr&gt;
            &lt;tr id="r3"&gt;&lt;td id="colId_r3"&gt;3&lt;/td&gt;&lt;td id="colName_r3"&gt;Charlie&lt;/td&gt;&lt;td id="colCity_r3"&gt;Berlin&lt;/td&gt;&lt;td id="colCountry_r3"&gt;Allemagne&lt;/td&gt;&lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;
    &lt;button id="resetOrderBtn"&gt;Réinitialiser l'ordre&lt;/button&gt;

    &lt;script type="module"&gt;
        import TableFlow from '../src/tableFlow.js'; // Ajustez le chemin

        const reorderTable = new TableFlow({
            tableId: 'reorderExampleTable',
            pluginsPath: '../plugins', // Ajustez
            debug: true,
            plugins: {
                names: ['ColumnReorder'], // Activer le plugin
                columnreorder: {
                    // Utiliser la config par défaut, sauf peut-être le sélecteur d'exclusion
                    // excludeSelector: '[th-noreorder]', // Exclure seulement th-noreorder
                    persistOrder: true // Sauvegarder l'ordre
                    // Ajouter des callbacks si besoin
                    // onColumnReorder: (details) => console.log('Colonnes réorganisées:', details.newOrder),
                }
            }
        });

        // Attendre que l'instance soit prête pour attacher le listener au bouton reset
        reorderTable.ready().then(instance => {
            const reorderPlugin = instance.getPlugin('columnreorder');
            const resetButton = document.getElementById('resetOrderBtn');
            if (resetButton && reorderPlugin) {
                resetButton.addEventListener('click', () => {
                    reorderPlugin.resetColumnOrder();
                });
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

                <strong>Fonctionnement de l'exemple :</strong>
                <ol>
                    <li>La table s'affiche. Les colonnes "Nom", "Ville" et "Pays" ont une petite icône de poignée <i class="fas fa-grip-vertical"></i> au début de leur en-tête. La colonne "ID" n'en a pas car elle a l'attribut `th-noreorder`.</li>
                    <li>Cliquez et maintenez sur la poignée d'une colonne (ex: "Ville") et déplacez la souris horizontalement.</li>
                    <li>Un "fantôme" de l'en-tête suit le curseur, et un indicateur vertical apparaît entre les autres colonnes pour montrer où la colonne "Ville" serait insérée si vous relâchiez le bouton.</li>
                    <li>Relâchez le bouton de la souris sur une position valide (entre deux autres colonnes réorganisables).</li>
                    <li>La colonne "Ville" (en-tête et toutes les cellules `<td>` correspondantes) se déplace à la nouvelle position dans le DOM.</li>
                    <li>L'ordre [ID, Nom, Pays, Ville] (par exemple) est sauvegardé dans le `localStorage`. Si vous rechargez la page, cet ordre sera restauré.</li>
                    <li>Cliquer sur le bouton "Réinitialiser l'ordre" remettra les colonnes dans leur ordre initial [ID, Nom, Ville, Pays] et supprimera la sauvegarde locale.</li>
                </ol>
            </section>

        </div>
    </div>
</body>
</html>
